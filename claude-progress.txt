# microBPF Development Progress

## Project Summary
microBPF is a sandboxed, event-driven in-kernel programmability system for constrained
kernels (RTOS, microkernels, embedded). Uses MQuickJS as execution engine.
Defines: host ABI (helpers/maps), .mbpf package format, runtime resource model, hook model.

## Tasks Identified: 97 total
- Infrastructure: 12 (setup, tests, docs)
- Functional: 71 (package format, runtime, maps, helpers, hooks, toolchain)
- Security: 8 (signing, capabilities, isolation, fuzzing)
- Performance: 4 (ROM stdlib, lock-free reads, no-alloc paths)

## Recommended Architecture
- Language: C (for embedded compatibility and MQuickJS integration)
- Build: CMake or Makefile (cross-platform, embedded-friendly)
- MQuickJS: Git submodule or vendored copy
- Toolchain: Separate CLI tools in C or Python for .mbpf assembly
- Tests: Unity or custom C test framework; fuzzing via libFuzzer

## Current Status
NOT YET IMPLEMENTED. First working agent should start with "project-setup" task.

## Key Implementation Phases (from spec)
1. Runtime MVP: package parsing, single hook, step budgeting, log helper
2. Maps MVP: array + hash maps, JS map API
3. Attach API: hook registry, multiple programs, per-CPU instances
4. Signing: Ed25519 verification and policy engine
5. Observability: counters, debug symbols, event output
- 2024-12-24: Project setup complete with MQuickJS integration and build scaffolding.
- 2025-12-24: Package header parsing implemented (magic/version/header size/section count) and tests/tools added.
- 2025-12-24: Implemented .mbpf section descriptor parsing with bounds/overlap validation and added section table tests.
- 2025-12-24: Package manifest parsing completed with CBOR/JSON support and manifest tests.
- 2025-12-24: Bytecode section handling now validates, relocates, and loads MQuickJS bytecode with tests.
- 2025-12-24: Added CRC32 validation for package headers/sections with tests.
- 2025-12-24: Added Ed25519 package signature verification, header APIs, and signing tests.
- 2025-12-24: Reviewed and validated runtime init/shutdown APIs with runtime tests.
- 2025-12-24: Verified mbpf_program_load basic behavior with new program load tests.
